function D(e,t,n){const i=typeof e;if(!n.includes(i))throw new TypeError(`${t} value must be ${n.join(" or ")}, received "${i}"`)}function Ce(e){return e==null&&(e=[]),Array.isArray(e)?e:[e]}function ve(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}function Xe(){}function ce(e,t,n=void 0){const i=t.replace(/\[(\d+)\]/g,".$1").split(".");let r=e;for(const s of i)if(r=new Object(r)[s],r===void 0)return n;return r}function ue(){let e=null,t=null;const n=new Promise((i,r)=>{e=i,t=r});return n.resolve=e,n.reject=t,n}function Ye(e){if(!Number.isNaN(e))return!1;const t=new Float64Array(1);return t[0]=e,new Uint32Array(t.buffer)[1]>>>31===1}const le=Symbol("vitest:SAFE_TIMERS");function Ie(){const{setTimeout:e,setInterval:t,clearInterval:n,clearTimeout:i,setImmediate:r,clearImmediate:s,queueMicrotask:o}=globalThis[le]||globalThis,{nextTick:c}=globalThis[le]||globalThis.process||{};return{nextTick:c,setTimeout:e,setInterval:t,clearInterval:n,clearTimeout:i,setImmediate:r,clearImmediate:s,queueMicrotask:o}}const ae={bold:["1","22"],dim:["2","22"],italic:["3","23"],underline:["4","24"],inverse:["7","27"],hidden:["8","28"],strike:["9","29"],black:["30","39"],red:["31","39"],green:["32","39"],yellow:["33","39"],blue:["34","39"],magenta:["35","39"],cyan:["36","39"],white:["37","39"],brightblack:["30;1","39"],brightred:["31;1","39"],brightgreen:["32;1","39"],brightyellow:["33;1","39"],brightblue:["34;1","39"],brightmagenta:["35;1","39"],brightcyan:["36;1","39"],brightwhite:["37;1","39"],grey:["90","39"]},Ze={special:"cyan",number:"yellow",bigint:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",symbol:"green",date:"magenta",regexp:"red"},R="…";function Ge(e,t){const n=ae[Ze[t]]||ae[t]||"";return n?`\x1B[${n[0]}m${String(e)}\x1B[${n[1]}m`:String(e)}function Je({showHidden:e=!1,depth:t=2,colors:n=!1,customInspect:i=!0,showProxy:r=!1,maxArrayLength:s=1/0,breakLength:o=1/0,seen:c=[],truncate:u=1/0,stylize:l=String}={},a){const f={showHidden:!!e,depth:Number(t),colors:!!n,customInspect:!!i,showProxy:!!r,maxArrayLength:Number(s),breakLength:Number(o),truncate:Number(u),seen:c,inspect:a,stylize:l};return f.colors&&(f.stylize=Ge),f}function Qe(e){return e>="\uD800"&&e<="\uDBFF"}function I(e,t,n=R){e=String(e);const i=n.length,r=e.length;if(i>t&&r>i)return n;if(r>t&&r>i){let s=t-i;return s>0&&Qe(e[s-1])&&(s=s-1),`${e.slice(0,s)}${n}`}return e}function A(e,t,n,i=", "){n=n||t.inspect;const r=e.length;if(r===0)return"";const s=t.truncate;let o="",c="",u="";for(let l=0;l<r;l+=1){const a=l+1===e.length,f=l+2===e.length;u=`${R}(${e.length-l})`;const p=e[l];t.truncate=s-o.length-(a?0:i.length);const d=c||n(p,t)+(a?"":i),g=o.length+d.length,b=g+u.length;if(a&&g>s&&o.length+u.length<=s||!a&&!f&&b>s||(c=a?"":n(e[l+1],t)+(f?"":i),!a&&f&&b>s&&g+c.length>s))break;if(o+=d,!a&&!f&&g+c.length>=s){u=`${R}(${e.length-l-1})`;break}u=""}return`${o}${u}`}function et(e){return e.match(/^[a-zA-Z_][a-zA-Z_0-9]*$/)?e:JSON.stringify(e).replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'")}function z([e,t],n){return n.truncate-=2,typeof e=="string"?e=et(e):typeof e!="number"&&(e=`[${n.inspect(e,n)}]`),n.truncate-=e.length,t=n.inspect(t,n),`${e}: ${t}`}function tt(e,t){const n=Object.keys(e).slice(e.length);if(!e.length&&!n.length)return"[]";t.truncate-=4;const i=A(e,t);t.truncate-=i.length;let r="";return n.length&&(r=A(n.map(s=>[s,e[s]]),t,z)),`[ ${i}${r?`, ${r}`:""} ]`}const nt=e=>typeof Buffer=="function"&&e instanceof Buffer?"Buffer":e[Symbol.toStringTag]?e[Symbol.toStringTag]:e.constructor.name;function _(e,t){const n=nt(e);t.truncate-=n.length+4;const i=Object.keys(e).slice(e.length);if(!e.length&&!i.length)return`${n}[]`;let r="";for(let o=0;o<e.length;o++){const c=`${t.stylize(I(e[o],t.truncate),"number")}${o===e.length-1?"":", "}`;if(t.truncate-=c.length,e[o]!==e.length&&t.truncate<=3){r+=`${R}(${e.length-e[o]+1})`;break}r+=c}let s="";return i.length&&(s=A(i.map(o=>[o,e[o]]),t,z)),`${n}[ ${r}${s?`, ${s}`:""} ]`}function rt(e,t){const n=e.toJSON();if(n===null)return"Invalid Date";const i=n.split("T"),r=i[0];return t.stylize(`${r}T${I(i[1],t.truncate-r.length-1)}`,"date")}function fe(e,t){const n=e[Symbol.toStringTag]||"Function",i=e.name;return i?t.stylize(`[${n} ${I(i,t.truncate-11)}]`,"special"):t.stylize(`[${n}]`,"special")}function it([e,t],n){return n.truncate-=4,e=n.inspect(e,n),n.truncate-=e.length,t=n.inspect(t,n),`${e} => ${t}`}function ot(e){const t=[];return e.forEach((n,i)=>{t.push([i,n])}),t}function st(e,t){return e.size===0?"Map{}":(t.truncate-=7,`Map{ ${A(ot(e),t,it)} }`)}const ct=Number.isNaN||(e=>e!==e);function he(e,t){return ct(e)?t.stylize("NaN","number"):e===1/0?t.stylize("Infinity","number"):e===-1/0?t.stylize("-Infinity","number"):e===0?t.stylize(1/e===1/0?"+0":"-0","number"):t.stylize(I(String(e),t.truncate),"number")}function de(e,t){let n=I(e.toString(),t.truncate-1);return n!==R&&(n+="n"),t.stylize(n,"bigint")}function ut(e,t){const n=e.toString().split("/")[2],i=t.truncate-(2+n.length),r=e.source;return t.stylize(`/${I(r,i)}/${n}`,"regexp")}function lt(e){const t=[];return e.forEach(n=>{t.push(n)}),t}function at(e,t){return e.size===0?"Set{}":(t.truncate-=7,`Set{ ${A(lt(e),t)} }`)}const pe=new RegExp("['\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]","g"),ft={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"},ht=16;function dt(e){return ft[e]||`\\u${`0000${e.charCodeAt(0).toString(ht)}`.slice(-4)}`}function ge(e,t){return pe.test(e)&&(e=e.replace(pe,dt)),t.stylize(`'${I(e,t.truncate-2)}'`,"string")}function me(e){return"description"in Symbol.prototype?e.description?`Symbol(${e.description})`:"Symbol()":e.toString()}const pt=()=>"Promise{…}";function V(e,t){const n=Object.getOwnPropertyNames(e),i=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[];if(n.length===0&&i.length===0)return"{}";if(t.truncate-=4,t.seen=t.seen||[],t.seen.includes(e))return"[Circular]";t.seen.push(e);const r=A(n.map(c=>[c,e[c]]),t,z),s=A(i.map(c=>[c,e[c]]),t,z);t.seen.pop();let o="";return r&&s&&(o=", "),`{ ${r}${o}${s} }`}const X=typeof Symbol<"u"&&Symbol.toStringTag?Symbol.toStringTag:!1;function gt(e,t){let n="";return X&&X in e&&(n=e[X]),n=n||e.constructor.name,(!n||n==="_class")&&(n="<Anonymous Class>"),t.truncate-=n.length,`${n}${V(e,t)}`}function mt(e,t){return e.length===0?"Arguments[]":(t.truncate-=13,`Arguments[ ${A(e,t)} ]`)}const yt=["stack","line","column","name","message","fileName","lineNumber","columnNumber","number","description","cause"];function bt(e,t){const n=Object.getOwnPropertyNames(e).filter(o=>yt.indexOf(o)===-1),i=e.name;t.truncate-=i.length;let r="";if(typeof e.message=="string"?r=I(e.message,t.truncate):n.unshift("message"),r=r?`: ${r}`:"",t.truncate-=r.length+5,t.seen=t.seen||[],t.seen.includes(e))return"[Circular]";t.seen.push(e);const s=A(n.map(o=>[o,e[o]]),t,z);return`${i}${r}${s?` { ${s} }`:""}`}function St([e,t],n){return n.truncate-=3,t?`${n.stylize(String(e),"yellow")}=${n.stylize(`"${t}"`,"string")}`:`${n.stylize(String(e),"yellow")}`}function Q(e,t){return A(e,t,Tt,`
`)}function Tt(e,t){switch(e.nodeType){case 1:return Ne(e,t);case 3:return t.inspect(e.data,t);default:return t.inspect(e,t)}}function Ne(e,t){const n=e.getAttributeNames(),i=e.tagName.toLowerCase(),r=t.stylize(`<${i}`,"special"),s=t.stylize(">","special"),o=t.stylize(`</${i}>`,"special");t.truncate-=i.length*2+5;let c="";n.length>0&&(c+=" ",c+=A(n.map(a=>[a,e.getAttribute(a)]),t,St," ")),t.truncate-=c.length;const u=t.truncate;let l=Q(e.children,t);return l&&l.length>u&&(l=`${R}(${e.children.length})`),`${r}${c}${s}${l}${o}`}const wt=typeof Symbol=="function"&&typeof Symbol.for=="function",Y=wt?Symbol.for("chai/inspect"):"@@chai/inspect",Z=Symbol.for("nodejs.util.inspect.custom"),ye=new WeakMap,be={},Se={undefined:(e,t)=>t.stylize("undefined","undefined"),null:(e,t)=>t.stylize("null","null"),boolean:(e,t)=>t.stylize(String(e),"boolean"),Boolean:(e,t)=>t.stylize(String(e),"boolean"),number:he,Number:he,bigint:de,BigInt:de,string:ge,String:ge,function:fe,Function:fe,symbol:me,Symbol:me,Array:tt,Date:rt,Map:st,Set:at,RegExp:ut,Promise:pt,WeakSet:(e,t)=>t.stylize("WeakSet{…}","special"),WeakMap:(e,t)=>t.stylize("WeakMap{…}","special"),Arguments:mt,Int8Array:_,Uint8Array:_,Uint8ClampedArray:_,Int16Array:_,Uint16Array:_,Int32Array:_,Uint32Array:_,Float32Array:_,Float64Array:_,Generator:()=>"",DataView:()=>"",ArrayBuffer:()=>"",Error:bt,HTMLCollection:Q,NodeList:Q},At=(e,t,n,i)=>Y in e&&typeof e[Y]=="function"?e[Y](t):Z in e&&typeof e[Z]=="function"?e[Z](t.depth,t,i):"inspect"in e&&typeof e.inspect=="function"?e.inspect(t.depth,t):"constructor"in e&&ye.has(e.constructor)?ye.get(e.constructor)(e,t):be[n]?be[n](e,t):"",Et=Object.prototype.toString;function q(e,t={}){const n=Je(t,q),{customInspect:i}=n;let r=e===null?"null":typeof e;if(r==="object"&&(r=Et.call(e).slice(8,-1)),r in Se)return Se[r](e,n);if(i&&e){const o=At(e,n,r,q);if(o)return typeof o=="string"?o:q(o,n)}const s=e?Object.getPrototypeOf(e):!1;return s===Object.prototype||s===null?V(e,n):e&&typeof HTMLElement=="function"&&e instanceof HTMLElement?Ne(e,n):"constructor"in e?e.constructor!==Object?gt(e,n):V(e,n):e===Object(e)?V(e,n):n.stylize(String(e),r)}const xe=/%[sdjifoOc%]/g;function kt(...e){if(typeof e[0]!="string"){const s=[];for(let o=0;o<e.length;o++)s.push(x(e[o],{depth:0,colors:!1}));return s.join(" ")}const t=e.length;let n=1;const i=e[0];let r=String(i).replace(xe,s=>{if(s==="%%")return"%";if(n>=t)return s;switch(s){case"%s":{const o=e[n++];return typeof o=="bigint"?`${o.toString()}n`:typeof o=="number"&&o===0&&1/o<0?"-0":typeof o=="object"&&o!==null?typeof o.toString=="function"&&o.toString!==Object.prototype.toString?o.toString():x(o,{depth:0,colors:!1}):String(o)}case"%d":{const o=e[n++];return typeof o=="bigint"?`${o.toString()}n`:Number(o).toString()}case"%i":{const o=e[n++];return typeof o=="bigint"?`${o.toString()}n`:Number.parseInt(String(o)).toString()}case"%f":return Number.parseFloat(String(e[n++])).toString();case"%o":return x(e[n++],{showHidden:!0,showProxy:!0});case"%O":return x(e[n++]);case"%c":return n++,"";case"%j":try{return JSON.stringify(e[n++])}catch(o){const c=o.message;if(c.includes("circular structure")||c.includes("cyclic structures")||c.includes("cyclic object"))return"[Circular]";throw o}default:return s}});for(let s=e[n];n<t;s=e[++n])s===null||typeof s!="object"?r+=` ${s}`:r+=` ${x(s)}`;return r}function x(e,t={}){return t.truncate===0&&(t.truncate=Number.POSITIVE_INFINITY),q(e,t)}function _t(e,t={}){typeof t.truncate>"u"&&(t.truncate=40);const n=x(e,t),i=Object.prototype.toString.call(e);if(t.truncate&&n.length>=t.truncate)if(i==="[object Function]"){const r=e;return r.name?`[Function: ${r.name}]`:"[Function]"}else{if(i==="[object Array]")return`[ Array(${e.length}) ]`;if(i==="[object Object]"){const r=Object.keys(e);return`{ Object (${r.length>2?`${r.splice(0,2).join(", ")}, ...`:r.join(", ")}) }`}else return n}return n}const $t=/^[A-Za-z]:\//;function Ct(e=""){return e&&e.replace(/\\/g,"/").replace($t,t=>t.toUpperCase())}const vt=/^[/\\](?![/\\])|^[/\\]{2}(?!\.)|^[A-Za-z]:[/\\]/;function It(){return typeof process<"u"&&typeof process.cwd=="function"?process.cwd().replace(/\\/g,"/"):"/"}const Nt=function(...e){e=e.map(i=>Ct(i));let t="",n=!1;for(let i=e.length-1;i>=-1&&!n;i--){const r=i>=0?e[i]:It();!r||r.length===0||(t=`${r}/${t}`,n=Te(r))}return t=xt(t,!n),n&&!Te(t)?`/${t}`:t.length>0?t:"."};function xt(e,t){let n="",i=0,r=-1,s=0,o=null;for(let c=0;c<=e.length;++c){if(c<e.length)o=e[c];else{if(o==="/")break;o="/"}if(o==="/"){if(!(r===c-1||s===1))if(s===2){if(n.length<2||i!==2||n[n.length-1]!=="."||n[n.length-2]!=="."){if(n.length>2){const u=n.lastIndexOf("/");u===-1?(n="",i=0):(n=n.slice(0,u),i=n.length-1-n.lastIndexOf("/")),r=c,s=0;continue}else if(n.length>0){n="",i=0,r=c,s=0;continue}}t&&(n+=n.length>0?"/..":"..",i=2)}else n.length>0?n+=`/${e.slice(r+1,c)}`:n=e.slice(r+1,c),i=c-r-1;r=c,s=0}else o==="."&&s!==-1?++s:s=-1}return n}const Te=function(e){return vt.test(e)};var we="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ft=new Uint8Array(64),jt=new Uint8Array(128);for(let e=0;e<we.length;e++){const t=we.charCodeAt(e);Ft[e]=t,jt[t]=e}const Fe=/^\s*at .*(?:\S:\d+|\(native\))/m,Rt=/^(?:eval@)?(?:\[native code\])?$/;function je(e){if(!e.includes(":"))return[e];const n=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/^\(|\)$/g,""));if(!n)return[e];let i=n[1];if(i.startsWith("async ")&&(i=i.slice(6)),i.startsWith("http:")||i.startsWith("https:")){const r=new URL(i);r.searchParams.delete("import"),r.searchParams.delete("browserv"),i=r.pathname+r.hash+r.search}if(i.startsWith("/@fs/")){const r=/^\/@fs\/[a-zA-Z]:\//.test(i);i=i.slice(r?5:4)}return[i,n[2]||void 0,n[3]||void 0]}function Ot(e){let t=e.trim();if(Rt.test(t)||(t.includes(" > eval")&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),!t.includes("@")))return null;let n=-1,i="",r;for(let u=0;u<t.length;u++)if(t[u]==="@"){const l=t.slice(u+1);if(l.includes(":")&&l.length>=3){n=u,i=l,r=u>0?t.slice(0,u):void 0;break}}if(n===-1||!i.includes(":")||i.length<3)return null;const[s,o,c]=je(i);return!s||!o||!c?null:{file:s,method:r||"",line:Number.parseInt(o),column:Number.parseInt(c)}}function Pt(e){const t=e.trim();return Fe.test(t)?Mt(t):Ot(t)}function Mt(e){let t=e.trim();if(!Fe.test(t))return null;t.includes("(eval ")&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));let n=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,"");const i=n.match(/ (\(.+\)$)/);n=i?n.replace(i[0],""):n;const[r,s,o]=je(i?i[1]:n);let c=i&&n||"",u=r&&["eval","<anonymous>"].includes(r)?void 0:r;return!u||!s||!o?null:(c.startsWith("async ")&&(c=c.slice(6)),u.startsWith("file://")&&(u=u.slice(7)),u=u.startsWith("node:")||u.startsWith("internal:")?u:Nt(u),c&&(c=c.replace(/__vite_ssr_import_\d+__\./g,"").replace(/(Object\.)?__vite_ssr_export_default__\s?/g,"")),{method:c,file:u,line:Number.parseInt(s),column:Number.parseInt(o)})}function te(e,t){function n(r){const s=function(...o){return t.apply(r,o)};Object.assign(s,t),s.withContext=()=>s.bind(r),s.setContext=(o,c)=>{r[o]=c},s.mergeContext=o=>{Object.assign(r,o)};for(const o of e)Object.defineProperty(s,o,{get(){return n({...r,[o]:!0})}});return s}const i=n({});return i.fn=t,i}function Re(e,t){const n=t.split(`
`).slice(1);for(const i of n){const r=Pt(i);if(r&&r.file===e)return r}}class zt extends Error{code="VITEST_PENDING";taskId;constructor(t,n,i){super(t),this.message=t,this.note=i,this.taskId=n.id}}const Oe=new WeakMap,Pe=new WeakMap,Me=new WeakMap;function Wt(e,t){Oe.set(e,t)}function Tn(e){return Oe.get(e)}function Lt(e,t){Pe.set(e,t)}function Ut(e){return Pe.get(e)}function Vt(e,t){Me.set(e,t)}function qt(e){return Me.get(e)}function Bt(e,t){const n=t.reduce((s,o)=>(s[o.prop]=o,s),{}),i={};e.forEach(s=>{const o=n[s.prop]||{...s};i[o.prop]=o});for(const s in i){var r;const o=i[s];o.deps=(r=o.deps)===null||r===void 0?void 0:r.map(c=>i[c.prop])}return Object.values(i)}function ze(e,t,n){const i=["auto","injected","scope"],r=Object.entries(e).map(([s,o])=>{const c={value:o};if(Array.isArray(o)&&o.length>=2&&ve(o[1])&&Object.keys(o[1]).some(l=>i.includes(l))){var u;Object.assign(c,o[1]);const l=o[0];c.value=c.injected?((u=n.injectValue)===null||u===void 0?void 0:u.call(n,s))??l:l}return c.scope=c.scope||"test",c.scope==="worker"&&!n.getWorkerContext&&(c.scope="file"),c.prop=s,c.isFn=typeof c.value=="function",c});return Array.isArray(t.fixtures)?t.fixtures=t.fixtures.concat(r):t.fixtures=r,r.forEach(s=>{if(s.isFn){const c=Le(s.value);if(c.length&&(s.deps=t.fixtures.filter(({prop:u})=>u!==s.prop&&c.includes(u))),s.scope!=="test"){var o;(o=s.deps)===null||o===void 0||o.forEach(u=>{if(u.isFn&&!(s.scope==="worker"&&u.scope==="worker")&&!(s.scope==="file"&&u.scope!=="test"))throw new SyntaxError(`cannot use the ${u.scope} fixture "${u.prop}" inside the ${s.scope} fixture "${s.prop}"`)})}}}),t}const G=new Map,F=new Map;function ne(e,t,n){return i=>{const r=i||n;if(!r)return t({});const s=Ut(r);if(!s?.length)return t(r);const o=Le(t),c=s.some(({auto:d})=>d);if(!o.length&&!c)return t(r);G.get(r)||G.set(r,new Map);const u=G.get(r);F.has(r)||F.set(r,[]);const l=F.get(r),a=s.filter(({prop:d,auto:g})=>g||o.includes(d)),f=We(a);if(!f.length)return t(r);async function p(){for(const d of f){if(u.has(d))continue;const g=await Kt(e,d,r,l);r[d.prop]=g,u.set(d,g),d.scope==="test"&&l.unshift(()=>{u.delete(d)})}}return p().then(()=>t(r))}}const U=new WeakMap;function Kt(e,t,n,i){var r;const s=an(n.task.file),o=(r=e.getWorkerContext)===null||r===void 0?void 0:r.call(e);if(!t.isFn){var c;if(s[c=t.prop]??(s[c]=t.value),o){var u;o[u=t.prop]??(o[u]=t.value)}return t.value}if(t.scope==="test")return Ae(t.value,n,i);if(U.has(t))return U.get(t);let l;if(t.scope==="worker"){if(!o)throw new TypeError("[@vitest/runner] The worker context is not available in the current test runner. Please, provide the `getWorkerContext` method when initiating the runner.");l=o}else l=s;if(t.prop in l)return l[t.prop];F.has(l)||F.set(l,[]);const a=F.get(l),f=Ae(t.value,l,a).then(p=>(l[t.prop]=p,U.delete(t),p));return U.set(t,f),f}async function Ae(e,t,n){const i=ue();let r=!1;const s=e(t,async o=>{r=!0,i.resolve(o);const c=ue();n.push(async()=>{c.resolve(),await s}),await c}).catch(o=>{if(!r){i.reject(o);return}throw o});return i}function We(e,t=new Set,n=[]){return e.forEach(i=>{if(!n.includes(i)){if(!i.isFn||!i.deps){n.push(i);return}if(t.has(i))throw new Error(`Circular fixture dependency detected: ${i.prop} <- ${[...t].reverse().map(r=>r.prop).join(" <- ")}`);t.add(i),We(i.deps,t,n),n.push(i),t.clear()}}),n}function Le(e){let t=Dt(e.toString());/__async\((?:this|null), (?:null|arguments|\[[_0-9, ]*\]), function\*/.test(t)&&(t=t.split(/__async\((?:this|null),/)[1]);const n=t.match(/[^(]*\(([^)]*)/);if(!n)return[];const i=Ee(n[1]);if(!i.length)return[];let r=i[0];if("__VITEST_FIXTURE_INDEX__"in e&&(r=i[e.__VITEST_FIXTURE_INDEX__],!r))return[];if(!(r[0]==="{"&&r.endsWith("}")))throw new Error(`The first argument inside a fixture must use object destructuring pattern, e.g. ({ test } => {}). Instead, received "${r}".`);const s=r.slice(1,-1).replace(/\s/g,""),o=Ee(s).map(u=>u.replace(/:.*|=.*/g,"")),c=o.at(-1);if(c&&c.startsWith("..."))throw new Error(`Rest parameters are not supported in fixtures, received "${c}".`);return o}function Dt(e){const t=[];let n="none";for(let i=0;i<e.length;++i)n==="singleline"?e[i]===`
`&&(n="none"):n==="multiline"?e[i-1]==="*"&&e[i]==="/"&&(n="none"):n==="none"&&(e[i]==="/"&&e[i+1]==="/"?n="singleline":e[i]==="/"&&e[i+1]==="*"?(n="multiline",i+=2):t.push(e[i]));return t.join("")}function Ee(e){const t=[],n=[];let i=0;for(let s=0;s<e.length;s++)if(e[s]==="{"||e[s]==="[")n.push(e[s]==="{"?"}":"]");else if(e[s]===n.at(-1))n.pop();else if(!n.length&&e[s]===","){const o=e.substring(i,s).trim();o&&t.push(o),i=s+1}const r=e.substring(i).trim();return r&&t.push(r),t}let Ht;function wn(){return Ht}const M=Jt();re(function(e,t,n){v().test.fn.call(this,$(e),t,n)});let E,Ue,Xt;function Ve(e,t){if(!e)throw new Error(`Vitest failed to find ${t}. This is a bug in Vitest. Please, open an issue with reproduction.`)}function H(){return Ve(E,"the runner"),E}function v(){const e=C.currentSuite||Ue;return Ve(e,"the current suite"),e}function Yt(){return{beforeAll:[],afterAll:[],beforeEach:[],afterEach:[]}}function j(e,t){if(t!=null&&typeof t=="object")throw new TypeError('Signature "test(name, fn, { ... })" was deprecated in Vitest 3 and removed in Vitest 4. Please, provide options as a second argument instead.');let n={},i;if(typeof t=="number"?n={timeout:t}:typeof e=="object"&&(n=e),typeof e=="function"){if(typeof t=="function")throw new TypeError("Cannot use two functions as arguments. Please use the second argument for options.");i=e}else typeof t=="function"&&(i=t);return{options:n,handler:i}}function Zt(e,t=()=>{},n,i,r,s){const o=[];let c;d();const u=function(y="",h={}){var m;const S=h?.timeout??E.config.testTimeout,T={id:"",name:y,suite:(m=C.currentSuite)===null||m===void 0?void 0:m.suite,each:h.each,fails:h.fails,context:void 0,type:"test",file:void 0,timeout:S,retry:h.retry??E.config.retry,repeats:h.repeats,mode:h.only?"only":h.skip?"skip":h.todo?"todo":"run",meta:h.meta??Object.create(null),annotations:[]},O=h.handler;T.mode==="run"&&!O&&(T.mode="todo"),(h.concurrent||!h.sequential&&E.config.sequence.concurrent)&&(T.concurrent=!0),T.shuffle=r?.shuffle;const L=cn(T,E);Object.defineProperty(T,"context",{value:L,enumerable:!1}),Lt(L,h.fixtures);const He=Error.stackTraceLimit;Error.stackTraceLimit=15;const oe=new Error("STACK_TRACE_ERROR");if(Error.stackTraceLimit=He,O&&Wt(T,N(Gt(ne(E,O,L),T),S,!1,oe,(se,P)=>ie([L],P))),E.config.includeTaskLocation){const se=oe.stack,P=Re(Xt,se);P&&(T.location={line:P.line,column:P.column})}return o.push(T),T},l=re(function(y,h,m){let{options:S,handler:T}=j(h,m);typeof r=="object"&&(S=Object.assign({},r,S)),S.concurrent=this.concurrent||!this.sequential&&S?.concurrent,S.sequential=this.sequential||!this.concurrent&&S?.sequential;const O=u($(y),{...this,...S,handler:T});O.type="test"});let a=s;const f={type:"collector",name:e,mode:n,suite:c,options:r,test:l,tasks:o,collect:b,task:u,clear:g,on:p,fixtures(){return a},scoped(y){const h=ze(y,{fixtures:a},E);h.fixtures&&(a=h.fixtures)}};function p(y,...h){qt(c)[y].push(...h)}function d(y){var h;typeof r=="number"&&(r={timeout:r}),c={id:"",type:"suite",name:e,suite:(h=C.currentSuite)===null||h===void 0?void 0:h.suite,mode:n,each:i,file:void 0,shuffle:r?.shuffle,tasks:[],meta:Object.create(null),concurrent:r?.concurrent},Vt(c,Yt())}function g(){o.length=0,d()}async function b(y){if(!y)throw new TypeError("File is required to collect tasks.");t&&await on(f,()=>t(l));const h=[];for(const m of o)h.push(m.type==="collector"?await m.collect(y):m);return c.file=y,c.tasks=h,h.forEach(m=>{m.file=y}),c}return rn(f),f}function Gt(e,t){return(async(...n)=>{const i=await e(...n);if(t.promises){const s=(await Promise.allSettled(t.promises)).map(o=>o.status==="rejected"?o.reason:void 0).filter(Boolean);if(s.length)throw s}return i})}function Jt(){function e(t,n,i){var r;let s=this.only?"only":this.skip?"skip":this.todo?"todo":"run";const o=C.currentSuite||Ue;let{options:c,handler:u}=j(n,i);s==="run"&&!u&&(s="todo");const l=c.concurrent||this.concurrent||c.sequential===!1,a=c.sequential||this.sequential||c.concurrent===!1;c={...o?.options,...c,shuffle:this.shuffle??c.shuffle??(o==null||(r=o.options)===null||r===void 0?void 0:r.shuffle)??void 0};const f=l||c.concurrent&&!a,p=a||c.sequential&&!l;return c.concurrent=f&&!p,c.sequential=p&&!f,Zt($(t),u,s,this.each,c,o?.fixtures())}return e.each=function(t,...n){const i=this.withContext();return this.setContext("each",!0),Array.isArray(t)&&n.length&&(t=K(t,n)),(r,s,o)=>{const c=$(r),u=t.every(Array.isArray),{options:l,handler:a}=j(s,o),f=typeof s=="function";t.forEach((p,d)=>{const g=Array.isArray(p)?p:[p];f?u?i(k(c,g,d),a?()=>a(...g):void 0,l.timeout):i(k(c,g,d),a?()=>a(p):void 0,l.timeout):u?i(k(c,g,d),l,a?()=>a(...g):void 0):i(k(c,g,d),l,a?()=>a(p):void 0)}),this.setContext("each",void 0)}},e.for=function(t,...n){return Array.isArray(t)&&n.length&&(t=K(t,n)),(i,r,s)=>{const o=$(i),{options:c,handler:u}=j(r,s);t.forEach((l,a)=>{M(k(o,Ce(l),a),c,u?()=>u(l):void 0)})}},e.skipIf=t=>t?M.skip:M,e.runIf=t=>t?M:M.skip,te(["concurrent","sequential","shuffle","skip","only","todo"],e)}function Qt(e,t){const n=e;n.each=function(r,...s){const o=this.withContext();return this.setContext("each",!0),Array.isArray(r)&&s.length&&(r=K(r,s)),(c,u,l)=>{const a=$(c),f=r.every(Array.isArray),{options:p,handler:d}=j(u,l),g=typeof u=="function";r.forEach((b,y)=>{const h=Array.isArray(b)?b:[b];g?f?o(k(a,h,y),d?()=>d(...h):void 0,p.timeout):o(k(a,h,y),d?()=>d(b):void 0,p.timeout):f?o(k(a,h,y),p,d?()=>d(...h):void 0):o(k(a,h,y),p,d?()=>d(b):void 0)}),this.setContext("each",void 0)}},n.for=function(r,...s){const o=this.withContext();return Array.isArray(r)&&s.length&&(r=K(r,s)),(c,u,l)=>{const a=$(c),{options:f,handler:p}=j(u,l);r.forEach((d,g)=>{const b=p?y=>p(d,y):void 0;b&&(b.__VITEST_FIXTURE_INDEX__=1,b.toString=()=>p.toString()),o(k(a,Ce(d),g),f,b)})}},n.skipIf=function(r){return r?this.skip:this},n.runIf=function(r){return r?this:this.skip},n.scoped=function(r){v().scoped(r)},n.extend=function(r){const s=ze(r,t||{},E),o=e;return re(function(c,u,l){const f=v().fixtures(),p={...this};f&&(p.fixtures=Bt(p.fixtures||[],f)),o.call(p,$(c),u,l)},s)},n.beforeEach=pn,n.afterEach=gn,n.beforeAll=hn,n.afterAll=dn;const i=te(["concurrent","sequential","skip","only","todo","fails"],n);return t&&i.mergeContext(t),i}function re(e,t){return Qt(e,t)}function $(e){return typeof e=="string"?e:typeof e=="function"?e.name||"<anonymous>":String(e)}function k(e,t,n){(e.includes("%#")||e.includes("%$"))&&(e=e.replace(/%%/g,"__vitest_escaped_%__").replace(/%#/g,`${n}`).replace(/%\$/g,`${n+1}`).replace(/__vitest_escaped_%__/g,"%%"));const i=e.split("%").length-1;e.includes("%f")&&(e.match(/%f/g)||[]).forEach((l,a)=>{if(Ye(t[a])||Object.is(t[a],-0)){let f=0;e=e.replace(/%f/g,p=>(f++,f===a+1?"-%f":p))}});const r=ve(t[0]);function s(u){return u.replace(/\$([$\w.]+)/g,(l,a)=>{const f=/^\d+$/.test(a);if(!r&&!f)return`$${a}`;const p=f?ce(t,a):void 0,d=r?ce(t[0],a,p):p;return _t(d,{truncate:void 0})})}let o="",c=0;return en(e,xe,u=>{c<i?o+=kt(u[0],t[c++]):o+=u[0]},u=>{o+=s(u)}),o}function en(e,t,n,i){let r=0;for(const s of e.matchAll(t))r<s.index&&i(e.slice(r,s.index)),n(s),r=s.index+s[0].length;r<e.length&&i(e.slice(r))}function K(e,t){const n=e.join("").trim().replace(/ /g,"").split(`
`).map(r=>r.split("|"))[0],i=[];for(let r=0;r<Math.floor(t.length/n.length);r++){const s={};for(let o=0;o<n.length;o++)s[n[o]]=t[r*n.length+o];i.push(s)}return i}globalThis.performance?globalThis.performance.now.bind(globalThis.performance):Date.now;globalThis.performance?globalThis.performance.now.bind(globalThis.performance):Date.now;Ie();const J=new Map,ke=[],B=[];function tn(e){if(J.size){var t;const n=Array.from(J).map(([r,s])=>[r,s[0],s[1]]),i=(t=e.onTaskUpdate)===null||t===void 0?void 0:t.call(e,n,ke);i&&(B.push(i),i.then(()=>B.splice(B.indexOf(i),1),()=>{})),ke.length=0,J.clear()}}async function nn(e){tn(e),await Promise.all(B)}const _e=Date.now,C={currentSuite:null};function rn(e){var t;(t=C.currentSuite)===null||t===void 0||t.tasks.push(e)}async function on(e,t){const n=C.currentSuite;C.currentSuite=e,await t(),C.currentSuite=n}function N(e,t,n=!1,i,r){if(t<=0||t===Number.POSITIVE_INFINITY)return e;const{setTimeout:s,clearTimeout:o}=Ie();return(function(...u){const l=_e(),a=H();return a._currentTaskStartTime=l,a._currentTaskTimeout=t,new Promise((f,p)=>{var d;const g=s(()=>{o(g),b()},t);(d=g.unref)===null||d===void 0||d.call(g);function b(){const m=un(n,t,i);r?.(u,m),p(m)}function y(m){if(a._currentTaskStartTime=void 0,a._currentTaskTimeout=void 0,o(g),_e()-l>=t){b();return}f(m)}function h(m){a._currentTaskStartTime=void 0,a._currentTaskTimeout=void 0,o(g),p(m)}try{const m=e(...u);typeof m=="object"&&m!=null&&typeof m.then=="function"?m.then(y,h):y(m)}catch(m){h(m)}})})}const ee=new WeakMap;function ie([e],t){e&&sn(e,t)}function sn(e,t){const n=ee.get(e);n?.abort(t)}function cn(e,t){var n;const i=function(){throw new Error("done() callback is deprecated, use promise instead")};let r=ee.get(i);r||(r=new AbortController,ee.set(i,r)),i.signal=r.signal,i.task=e,i.skip=(o,c)=>{if(o!==!1)throw e.result??(e.result={state:"skip"}),e.result.pending=!0,new zt("test is skipped; abort execution",e,typeof o=="string"?o:c)};async function s(o,c,u,l){const a={message:o,type:u||"notice"};if(l){if(l.body==null&&!l.path)throw new TypeError('Test attachment requires "body" or "path" to be set. Both are missing.');if(l.body&&l.path)throw new TypeError('Test attachment requires only one of "body" or "path" to be set. Both are specified.');a.attachment=l,l.body instanceof Uint8Array&&(l.body=fn(l.body))}if(c&&(a.location=c),!t.onTestAnnotate)throw new Error("Test runner doesn't support test annotations.");await nn(t);const f=await t.onTestAnnotate(e,a);return e.annotations.push(f),f}return i.annotate=((o,c,u)=>{if(e.result&&e.result.state!=="run")throw new Error(`Cannot annotate tests outside of the test run. The test "${e.name}" finished running with the "${e.result.state}" state already.`);const l=Re(e.file.filepath,new Error("STACK_TRACE").stack);let a;return l&&(a={file:l.file,line:l.line,column:l.column}),typeof c=="object"?$e(e,s(o,a,void 0,c)):$e(e,s(o,a,c,u))}),i.onTestFailed=(o,c)=>{e.onFailed||(e.onFailed=[]),e.onFailed.push(N(o,c??t.config.hookTimeout,!0,new Error("STACK_TRACE_ERROR"),(u,l)=>r.abort(l)))},i.onTestFinished=(o,c)=>{e.onFinished||(e.onFinished=[]),e.onFinished.push(N(o,c??t.config.hookTimeout,!0,new Error("STACK_TRACE_ERROR"),(u,l)=>r.abort(l)))},((n=t.extendTaskContext)===null||n===void 0?void 0:n.call(t,i))||i}function un(e,t,n){const i=`${e?"Hook":"Test"} timed out in ${t}ms.
If this is a long-running ${e?"hook":"test"}, pass a timeout value as the last argument or configure it globally with "${e?"hookTimeout":"testTimeout"}".`,r=new Error(i);return n?.stack&&(r.stack=n.stack.replace(r.message,n.message)),r}const ln=new WeakMap;function an(e){const t=ln.get(e);if(!t)throw new Error(`Cannot find file context for ${e.name}`);return t}const w=[];for(let e=65;e<91;e++)w.push(String.fromCharCode(e));for(let e=97;e<123;e++)w.push(String.fromCharCode(e));for(let e=0;e<10;e++)w.push(e.toString(10));w.push("+","/");function fn(e){let t="";const n=e.byteLength;for(let i=0;i<n;i+=3)if(n===i+1){const r=(e[i]&252)>>2,s=(e[i]&3)<<4;t+=w[r],t+=w[s],t+="=="}else if(n===i+2){const r=(e[i]&252)>>2,s=(e[i]&3)<<4|(e[i+1]&240)>>4,o=(e[i+1]&15)<<2;t+=w[r],t+=w[s],t+=w[o],t+="="}else{const r=(e[i]&252)>>2,s=(e[i]&3)<<4|(e[i+1]&240)>>4,o=(e[i+1]&15)<<2|(e[i+2]&192)>>6,c=e[i+2]&63;t+=w[r],t+=w[s],t+=w[o],t+=w[c]}return t}function $e(e,t){return t=t.finally(()=>{if(!e.promises)return;const n=e.promises.indexOf(t);n!==-1&&e.promises.splice(n,1)}),e.promises||(e.promises=[]),e.promises.push(t),t}function W(){return H().config.hookTimeout}const qe=Symbol.for("VITEST_CLEANUP_TIMEOUT"),Be=Symbol.for("VITEST_CLEANUP_STACK_TRACE");function hn(e,t=W()){D(e,'"beforeAll" callback',["function"]);const n=new Error("STACK_TRACE_ERROR");return v().on("beforeAll",Object.assign(N(e,t,!0,n),{[qe]:t,[Be]:n}))}function dn(e,t){return D(e,'"afterAll" callback',["function"]),v().on("afterAll",N(e,t??W(),!0,new Error("STACK_TRACE_ERROR")))}function pn(e,t=W()){D(e,'"beforeEach" callback',["function"]);const n=new Error("STACK_TRACE_ERROR"),i=H();return v().on("beforeEach",Object.assign(N(ne(i,e),t??W(),!0,n,ie),{[qe]:t,[Be]:n}))}function gn(e,t){D(e,'"afterEach" callback',["function"]);const n=H();return v().on("afterEach",N(ne(n,e),t??W(),!0,new Error("STACK_TRACE_ERROR"),ie))}const mn="__vitest_worker__";function yn(){const e=globalThis[mn];if(!e)throw new Error(`Vitest failed to access its internal state.

One of the following is possible:
- "vitest" is imported directly without running "vitest" command
- "vitest" is imported inside "globalSetup" (to fix this, use "setupFiles" instead, because "globalSetup" runs in a different context)
- "vitest" is imported inside Vite / Vitest config file
- Otherwise, it might be a Vitest bug. Please report it to https://github.com/vitest-dev/vitest/issues
`);return e}const Ke=new WeakMap,De=new WeakMap;function An(e){return De.get(e)}function En(e){return Ke.get(e)}bn(function(e,t=Xe,n={}){if(yn().config.mode!=="benchmark")throw new Error("`bench()` is only available in benchmark mode.");const i=v().task(Sn(e),{...this,meta:{benchmark:!0}});Ke.set(i,t),De.set(i,n),!this.todo&&i.mode==="todo"&&(i.mode="run")});function bn(e){const t=te(["skip","only","todo"],e);return t.skipIf=n=>n?t.skip:t,t.runIf=n=>n?t:t.skip,t}function Sn(e){return typeof e=="string"?e:typeof e=="function"?e.name||"<anonymous>":String(e)}export{te as createChainable,Qt as createTaskCollector,En as getBenchFn,An as getBenchOptions,v as getCurrentSuite,wn as getCurrentTest,Tn as getFn,qt as getHooks,Wt as setFn,Vt as setHooks};
