import{_ as rt}from"./preload-helper-PPVm8Dsz.js";function at(a){if(a?.includes("-"))throw new Error("Snapshot key cannot contain dash")}globalThis.__vitest_browser__&&rt(()=>import("./suite-DJvvCDtd.js"),[],import.meta.url).then(a=>{});function ft(a){return typeof a=="string"&&/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/.test(a)}const ht=/^[A-Za-z]:\//;function lt(a=""){return a&&a.replace(/\\/g,"/").replace(ht,d=>d.toUpperCase())}const ct=/^[/\\](?![/\\])|^[/\\]{2}(?!\.)|^[A-Za-z]:[/\\]/;function wt(){return typeof process<"u"&&typeof process.cwd=="function"?process.cwd().replace(/\\/g,"/"):"/"}const k=function(...a){a=a.map(m=>lt(m));let d="",n=!1;for(let m=a.length-1;m>=-1&&!n;m--){const M=m>=0?a[m]:wt();!M||M.length===0||(d=`${M}/${d}`,n=Z(M))}return d=gt(d,!n),n&&!Z(d)?`/${d}`:d.length>0?d:"."};function gt(a,d){let n="",m=0,M=-1,t=0,h=null;for(let r=0;r<=a.length;++r){if(r<a.length)h=a[r];else{if(h==="/")break;h="/"}if(h==="/"){if(!(M===r-1||t===1))if(t===2){if(n.length<2||m!==2||n[n.length-1]!=="."||n[n.length-2]!=="."){if(n.length>2){const w=n.lastIndexOf("/");w===-1?(n="",m=0):(n=n.slice(0,w),m=n.length-1-n.lastIndexOf("/")),M=r,t=0;continue}else if(n.length>0){n="",m=0,M=r,t=0;continue}}d&&(n+=n.length>0?"/..":"..",m=2)}else n.length>0?n+=`/${a.slice(M+1,r)}`:n=a.slice(M+1,r),m=r-M-1;M=r,t=0}else h==="."&&t!==-1?++t:t=-1}return n}const Z=function(a){return ct.test(a)};function G(a,d){var n=Object.keys(a);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);d&&(m=m.filter(function(M){return Object.getOwnPropertyDescriptor(a,M).enumerable})),n.push.apply(n,m)}return n}function W(a){for(var d=1;d<arguments.length;d++){var n=arguments[d]!=null?arguments[d]:{};d%2?G(Object(n),!0).forEach(function(m){vt(a,m,n[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach(function(m){Object.defineProperty(a,m,Object.getOwnPropertyDescriptor(n,m))})}return a}function vt(a,d,n){return d=pt(d),d in a?Object.defineProperty(a,d,{value:n,enumerable:!0,configurable:!0,writable:!0}):a[d]=n,a}function pt(a){var d=mt(a,"string");return typeof d=="symbol"?d:String(d)}function mt(a,d){if(typeof a!="object"||a===null)return a;var n=a[Symbol.toPrimitive];if(n!==void 0){var m=n.call(a,d);if(typeof m!="object")return m;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(a)}const Y=nt({});function nt(a){return d.withOptions=n=>nt(W(W({},a),n)),d;function d(n,...m){const M=typeof n=="string"?[n]:n.raw,{escapeSpecialCharacters:t=Array.isArray(n),trimWhitespace:h=!0}=a;let r="";for(let b=0;b<M.length;b++){let i=M[b];t&&(i=i.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\\{/g,"{")),r+=i,b<m.length&&(r+=m[b])}const w=r.split(`
`);let _=null;for(const b of w){const i=b.match(/^(\s+)\S+/);if(i){const u=i[1].length;_?_=Math.min(_,u):_=u}}if(_!==null){const b=_;r=w.map(i=>i[0]===" "||i[0]==="	"?i.slice(b):i).join(`
`)}return h&&(r=r.trim()),t&&(r=r.replace(/\\n/g,`
`)),r}}function yt(a,d,n,m,M,t={}){const{threshold:h=.1,alpha:r=.1,aaColor:w=[255,255,0],diffColor:_=[255,0,0],includeAA:b,diffColorAlt:i,diffMask:u}=t;if(!F(a)||!F(d)||n&&!F(n))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(a.length!==d.length||n&&n.length!==a.length)throw new Error("Image sizes do not match.");if(a.length!==m*M*4)throw new Error("Image data size does not match width/height.");const c=m*M,e=new Uint32Array(a.buffer,a.byteOffset,c),f=new Uint32Array(d.buffer,d.byteOffset,c);let o=!0;for(let P=0;P<c;P++)if(e[P]!==f[P]){o=!1;break}if(o){if(n&&!u)for(let P=0;P<c;P++)J(a,4*P,r,n);return 0}const s=35215*h*h,[y,v,p]=w,[l,g,S]=_,[A,O,x]=i||_;let E=0;for(let P=0;P<M;P++)for(let $=0;$<m;$++){const j=P*m+$,I=j*4,T=e[j]===f[j]?0:it(a,d,I,I,!1);if(Math.abs(T)>s){const D=X(a,$,P,m,M,e,f)||X(d,$,P,m,M,f,e);!b&&D?n&&!u&&L(n,I,y,v,p):(n&&(T<0?L(n,I,A,O,x):L(n,I,l,g,S)),E++)}else n&&!u&&J(a,I,r,n)}return E}function F(a){return ArrayBuffer.isView(a)&&a.BYTES_PER_ELEMENT===1}function X(a,d,n,m,M,t,h){const r=Math.max(d-1,0),w=Math.max(n-1,0),_=Math.min(d+1,m-1),b=Math.min(n+1,M-1),i=n*m+d;let u=d===r||d===_||n===w||n===b?1:0,c=0,e=0,f=0,o=0,s=0,y=0;for(let v=r;v<=_;v++)for(let p=w;p<=b;p++){if(v===d&&p===n)continue;const l=it(a,a,i*4,(p*m+v)*4,!0);if(l===0){if(u++,u>2)return!1}else l<c?(c=l,f=v,o=p):l>e&&(e=l,s=v,y=p)}return c===0||e===0?!1:q(t,f,o,m,M)&&q(h,f,o,m,M)||q(t,s,y,m,M)&&q(h,s,y,m,M)}function q(a,d,n,m,M){const t=Math.max(d-1,0),h=Math.max(n-1,0),r=Math.min(d+1,m-1),w=Math.min(n+1,M-1),_=a[n*m+d];let b=d===t||d===r||n===h||n===w?1:0;for(let i=t;i<=r;i++)for(let u=h;u<=w;u++)if(!(i===d&&u===n)&&(b+=+(_===a[u*m+i]),b>2))return!0;return!1}function it(a,d,n,m,M){const t=a[n],h=a[n+1],r=a[n+2],w=a[n+3],_=d[m],b=d[m+1],i=d[m+2],u=d[m+3];let c=t-_,e=h-b,f=r-i;const o=w-u;if(!c&&!e&&!f&&!o)return 0;if(w<255||u<255){const l=48+159*(n%2),g=48+159*((n/1.618033988749895|0)%2),S=48+159*((n/2.618033988749895|0)%2);c=(t*w-_*u-l*o)/255,e=(h*w-b*u-g*o)/255,f=(r*w-i*u-S*o)/255}const s=c*.29889531+e*.58662247+f*.11448223;if(M)return s;const y=c*.59597799-e*.2741761-f*.32180189,v=c*.21147017-e*.52261711+f*.31114694,p=.5053*s*s+.299*y*y+.1957*v*v;return s>0?-p:p}function L(a,d,n,m,M){a[d+0]=n,a[d+1]=m,a[d+2]=M,a[d+3]=255}function J(a,d,n,m){const M=255+(a[d]*.29889531+a[d+1]*.58662247+a[d+2]*.11448223-255)*n*a[d+3]/255;L(m,d,M,M,M)}var N={exports:{}},H;function bt(){return H||(H=1,(function(a,d){(function(n,m){a.exports=m()})(self,(function(){return(()=>{var n={132:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bezkrovnySsim=void 0;var r=h(490),w=h(971);function _(b,i,u){var c=b.data,e=i.data,f=u.bitDepth,o=u.k1,s=u.k2,y=Math.pow(2,f)-1,v=Math.pow(o*y,2),p=Math.pow(s*y,2),l=r.average(c),g=r.average(e),S=r.variance(c,l),A=r.variance(e,g);return(2*l*g+v)*(2*r.covariance(c,e,l,g)+p)/((Math.pow(l,2)+Math.pow(g,2)+v)*(S+A+p))}t.bezkrovnySsim=function(b,i,u){for(var c=u.windowSize,e=Math.ceil(b.width/c),f=Math.ceil(b.height/c),o=new Array(e*f),s=0,y=0;y<b.height;y+=c)for(var v=0;v<b.width;v+=c){var p=Math.min(c,b.width-v),l=Math.min(c,b.height-y),g=w.sub(b,v,l,y,p),S=w.sub(i,v,l,y,p);o[s++]=_(g,S,u)}return{data:o,width:e,height:f}}},63:(M,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaults=void 0,t.defaults={windowSize:11,k1:.01,k2:.03,bitDepth:8,downsample:"original",ssim:"weber",maxSize:256,rgb2grayVersion:"integer"}},441:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.downsample=void 0;var r=h(490),w=h(971);function _(b,i,u){var c=w.imfilter(b,i,"symmetric","same");return w.skip2d(c,[0,u,c.height],[0,u,c.width])}t.downsample=function(b,i){return i.downsample==="original"?(function(u,c,e){e===void 0&&(e=256);var f=Math.min(u.width,c.height)/e,o=Math.round(f);if(o>1){var s=w.ones(o);u=_(u,s=r.divide2d(s,r.sum2d(s)),o),c=_(c,s,o)}return[u,c]})(b[0],b[1],i.maxSize):b}},607:function(M,t,h){var r=this&&this.__assign||function(){return(r=Object.assign||function(v){for(var p,l=1,g=arguments.length;l<g;l++)for(var S in p=arguments[l])Object.prototype.hasOwnProperty.call(p,S)&&(v[S]=p[S]);return v}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ssim=t.getOptions=void 0;var w=h(971),_=h(490),b=h(773),i=h(595),u=h(132),c=h(441),e=h(63),f=h(535),o={fast:b.ssim,original:i.originalSsim,bezkrovny:u.bezkrovnySsim,weber:f.weberSsim};function s(v){var p=r(r({},e.defaults),v);return(function(l){if(Object.keys(l).forEach((function(g){if(!(g in e.defaults))throw new Error('"'+g+'" is not a valid option')})),"k1"in l&&(typeof l.k1!="number"||l.k1<0))throw new Error("Invalid k1 value. Default is "+e.defaults.k1);if("k2"in l&&(typeof l.k2!="number"||l.k2<0))throw new Error("Invalid k2 value. Default is "+e.defaults.k2);if(!(l.ssim in o))throw new Error("Invalid ssim option (use: "+Object.keys(o).join(", ")+")")})(p),p}function y(v,p,l){var g,S,A,O,x=new Date().getTime(),E=(function(P){var $=P[0],j=P[1],I=P[2];return o[I.ssim]($,j,I)})((function(P){var $=P[0],j=P[1],I=P[2],T=c.downsample([$,j],I);return[T[0],T[1],I]})((g=(function(P){var $=P[0],j=P[1],I=P[2];if($.width!==j.width||$.height!==j.height)throw new Error("Image dimensions do not match");return[$,j,I]})([v,p,s(l)]),S=g[0],A=g[1],(O=g[2]).rgb2grayVersion==="original"?[w.rgb2gray(S),w.rgb2gray(A),O]:[w.rgb2grayInteger(S),w.rgb2grayInteger(A),O])));return{mssim:E.mssim!==void 0?E.mssim:_.mean2d(E),ssim_map:E,performance:new Date().getTime()-x}}t.getOptions=s,t.ssim=y,t.default=y},490:(M,t)=>{function h(i){return r(i)/i.length}function r(i){for(var u=0,c=0;c<i.length;c++)u+=i[c];return u}function w(i){for(var u=i.data,c=0,e=0;e<u.length;e++)c+=u[e];return c}function _(i,u){for(var c=i.data,e=i.width,f=i.height,o=new Array(c.length),s=0;s<c.length;s++)o[s]=c[s]+u;return{data:o,width:e,height:f}}function b(i,u){return typeof u=="number"?(function(c,e){for(var f=c.data,o=c.width,s=c.height,y=new Array(f.length),v=0;v<f.length;v++)y[v]=f[v]*e;return{data:y,width:o,height:s}})(i,u):(function(c,e){for(var f=c.data,o=c.width,s=c.height,y=e.data,v=new Array(f.length),p=0;p<f.length;p++)v[p]=f[p]*y[p];return{data:v,width:o,height:s}})(i,u)}Object.defineProperty(t,"__esModule",{value:!0}),t.covariance=t.variance=t.mean2d=t.square2d=t.multiply2d=t.divide2d=t.subtract2d=t.add2d=t.sum2d=t.floor=t.sum=t.average=void 0,t.average=h,t.sum=r,t.floor=function(i){for(var u=new Array(i.length),c=0;c<i.length;c++)u[c]=Math.floor(i[c]);return u},t.sum2d=w,t.add2d=function(i,u){return typeof u=="number"?_(i,u):(function(c,e){for(var f=c.data,o=c.width,s=c.height,y=e.data,v=new Array(f.length),p=0;p<s;p++)for(var l=p*o,g=0;g<o;g++)v[l+g]=f[l+g]+y[l+g];return{data:v,width:o,height:s}})(i,u)},t.subtract2d=function(i,u){return typeof u=="number"?_(i,-u):(function(c,e){for(var f=c.data,o=c.width,s=c.height,y=e.data,v=new Array(f.length),p=0;p<s;p++)for(var l=p*o,g=0;g<o;g++)v[l+g]=f[l+g]-y[l+g];return{data:v,width:o,height:s}})(i,u)},t.divide2d=function(i,u){return typeof u=="number"?(function(c,e){for(var f=c.data,o=c.width,s=c.height,y=new Array(f.length),v=0;v<f.length;v++)y[v]=f[v]/e;return{data:y,width:o,height:s}})(i,u):(function(c,e){for(var f=c.data,o=c.width,s=c.height,y=e.data,v=new Array(f.length),p=0;p<f.length;p++)v[p]=f[p]/y[p];return{data:v,width:o,height:s}})(i,u)},t.multiply2d=b,t.square2d=function(i){return b(i,i)},t.mean2d=function(i){return w(i)/i.data.length},t.variance=function(i,u){u===void 0&&(u=h(i));for(var c=0,e=i.length;e--;)c+=Math.pow(i[e]-u,2);return c/i.length},t.covariance=function(i,u,c,e){c===void 0&&(c=h(i)),e===void 0&&(e=h(u));for(var f=0,o=i.length;o--;)f+=(i[o]-c)*(u[o]-e);return f/i.length}},687:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.conv2=void 0;var r=h(490),w=h(298),_=h(118),b=h(799);function i(o,s,y){var v=o.data,p=o.width,l=o.height;y===void 0&&(y="full");for(var g=p+s.width-1,S=l+s.height-1,A=b.zeros(S,g).data,O=0;O<s.height;O++)for(var x=0;x<s.width;x++){var E=s.data[O*s.width+x];if(E)for(var P=0;P<l;P++)for(var $=0;$<p;$++)A[(P+O)*g+$+x]+=v[P*p+$]*E}return f({data:A,width:g,height:S},y,l,s.height,p,s.width)}function u(o,s,y){var v=s.data,p=s.width,l=s.height;y===void 0&&(y="full");var g=e(o,w.ones(l,1),w.ones(1,p),y);return r.multiply2d(g,v[0])}function c(o){for(var s=o.data,y=s[0],v=1;v<s.length;v++)if(s[v]!==y)return!1;return!0}function e(o,s,y,v){v===void 0&&(v="full");var p=Math.max(s.height,s.width),l=Math.max(y.height,y.width),g=i(o,s,"full");return f(i(g,y,"full"),v,o.height,p,o.width,l)}function f(o,s,y,v,p,l){if(s==="full")return o;if(s==="same"){var g=Math.ceil((o.height-y)/2),S=Math.ceil((o.width-p)/2);return _.sub(o,g,y,S,p)}return _.sub(o,v-1,y-v+1,l-1,p-l+1)}t.conv2=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return o[2]&&o[2].data?e.apply(void 0,o):c(o[1])?u.apply(void 0,o):i.apply(void 0,o)}},346:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.filter2=void 0;var r=h(687);t.filter2=function(w,_,b){return b===void 0&&(b="same"),r.conv2(_,(function(i){for(var u=i.data,c=i.width,e=i.height,f=new Array(u.length),o=0;o<e;o++)for(var s=0;s<c;s++)f[o*c+s]=u[(e-1-o)*c+c-1-s];return{data:f,width:c,height:e}})(w),b)}},470:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fspecial=void 0;var r=h(490);t.fspecial=function(w,_,b){_===void 0&&(_=3),b===void 0&&(b=1.5);var i=(function(c,e){for(var f=c.data,o=c.width,s=c.height,y=new Array(f.length),v=0;v<f.length;v++)y[v]=Math.exp(-f[v]/(2*Math.pow(e,2)));return{data:y,width:o,height:s}})((function(c){for(var e=2*c+1,f=new Array(Math.pow(e,2)),o=0;o<e;o++)for(var s=0;s<e;s++)f[o*e+s]=Math.pow(o-c,2)+Math.pow(s-c,2);return{data:f,width:e,height:e}})(_=(_-1)/2),b),u=r.sum2d(i);return r.divide2d(i,u)}},521:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.imfilter=void 0;var r=h(20),w=h(389),_=h(490),b=h(346);t.imfilter=function(i,u,c,e){return c===void 0&&(c="symmetric"),e===void 0&&(e="same"),i=(function(f,o,s,y){if(f=w.padarray(f,_.floor([o/2,s/2]),y),r.mod(o,2)===0&&(f.data=f.data.slice(0,-f.width),f.height--),r.mod(s,2)===0){for(var v=[],p=0;p<f.data.length;p++)(p+1)%f.width!=0&&v.push(f.data[p]);f.data=v,f.width--}return f})(i,u.width,u.height,c),e=(function(f){return f==="same"&&(f="valid"),f})(e),b.filter2(u,i,e)}},971:function(M,t,h){var r=this&&this.__createBinding||(Object.create?function(_,b,i,u){u===void 0&&(u=i),Object.defineProperty(_,u,{enumerable:!0,get:function(){return b[i]}})}:function(_,b,i,u){u===void 0&&(u=i),_[u]=b[i]}),w=this&&this.__exportStar||function(_,b){for(var i in _)i==="default"||Object.prototype.hasOwnProperty.call(b,i)||r(b,_,i)};Object.defineProperty(t,"__esModule",{value:!0}),w(h(687),t),w(h(346),t),w(h(470),t),w(h(521),t),w(h(150),t),w(h(298),t),w(h(389),t),w(h(582),t),w(h(439),t),w(h(118),t),w(h(240),t),w(h(799),t)},928:(M,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.numbers=void 0,t.numbers=function(h,r,w){for(var _=r*h,b=new Array(_),i=0;i<_;i++)b[i]=w;return{data:b,width:r,height:h}}},20:(M,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mod=void 0,t.mod=function(h,r){return h-r*Math.floor(h/r)}},150:(M,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.normpdf=void 0,t.normpdf=function(h,r,w){var _=h.data,b=h.width,i=h.height;r===void 0&&(r=0),w===void 0&&(w=1);for(var u=new Array(_.length),c=0;c<_.length;c++){var e=(_[c]-r)/w;u[c]=Math.exp(-Math.pow(e,2)/2)/(2.5066282746310007*w)}return{data:u,width:b,height:i}}},298:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ones=void 0;var r=h(928);t.ones=function(w,_){return _===void 0&&(_=w),r.numbers(w,_,1)}},389:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.padarray=void 0;var r=h(20);t.padarray=function(w,_,b,i){var u=_[0],c=_[1];return w.height>=u&&w.width>=c?(function(e,f){for(var o=f[0],s=f[1],y=e.width+2*s,v=e.height+2*o,p=new Array(y*v),l=-o;l<0;l++){for(var g=-s;g<0;g++)p[(l+o)*y+g+s]=e.data[(Math.abs(l)-1)*e.width+Math.abs(g)-1];for(g=0;g<e.width;g++)p[(l+o)*y+g+s]=e.data[(Math.abs(l)-1)*e.width+g];for(g=e.width;g<e.width+s;g++)p[(l+o)*y+g+s]=e.data[(Math.abs(l)-1)*e.width+2*e.width-g-1]}for(l=0;l<e.height;l++){for(g=-s;g<0;g++)p[(l+o)*y+g+s]=e.data[l*e.width+Math.abs(g)-1];for(g=0;g<e.width;g++)p[(l+o)*y+g+s]=e.data[l*e.width+g];for(g=e.width;g<e.width+s;g++)p[(l+o)*y+g+s]=e.data[l*e.width+2*e.width-g-1]}for(l=e.height;l<e.height+o;l++){for(g=-s;g<0;g++)p[(l+o)*y+g+s]=e.data[(2*e.height-l-1)*e.width+Math.abs(g)-1];for(g=0;g<e.width;g++)p[(l+o)*y+g+s]=e.data[(2*e.height-l-1)*e.width+g];for(g=e.width;g<e.width+s;g++)p[(l+o)*y+g+s]=e.data[(2*e.height-l-1)*e.width+2*e.width-g-1]}return{data:p,width:y,height:v}})(w,[u,c]):(function(e,f){for(var o=(function(l,g){return{data:l.data.concat(g.data),height:l.height+g.height,width:l.width}})(e,(function(l){for(var g=l.data,S=l.width,A=l.height,O=new Array(g.length),x=0;x<A;x++)for(var E=0;E<S;E++)O[x*S+E]=g[(A-1-x)*S+E];return{data:O,width:S,height:A}})(e)),s=e.height+2*f,y=new Array(e.width*s),v=-f;v<e.height+f;v++)for(var p=0;p<e.width;p++)y[(v+f)*e.width+p]=o.data[r.mod(v,o.height)*e.width+p];return{data:y,width:e.width,height:s}})((function(e,f){for(var o=e.width+2*f,s=new Array(o*e.height),y=(function(l,g){for(var S=l.width+g.width,A=new Array(l.height*S),O=0;O<l.height;O++){for(var x=0;x<l.width;x++)A[O*S+x]=l.data[O*l.width+x];for(x=0;x<g.width;x++)A[O*S+x+l.width]=g.data[O*g.width+x]}return{data:A,width:S,height:l.height}})(e,(function(l){for(var g=l.data,S=l.width,A=l.height,O=new Array(g.length),x=0;x<A;x++)for(var E=0;E<S;E++)O[x*S+E]=g[x*S+S-1-E];return{data:O,width:S,height:A}})(e)),v=0;v<e.height;v++)for(var p=-f;p<e.width+f;p++)s[v*o+p+f]=y.data[v*y.width+r.mod(p,y.width)];return{data:s,width:o,height:e.height}})(w,c),u)}},582:(M,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.rgb2grayInteger=t.rgb2gray=void 0,t.rgb2gray=function(h){for(var r=h.data,w=h.width,_=h.height,b=new Uint8Array(w*_),i=0;i<r.length;i+=4)b[i/4]=.29894*r[i]+.58704*r[i+1]+.11402*r[i+2]+.5;return{data:Array.from(b),width:w,height:_}},t.rgb2grayInteger=function(h){for(var r=h.data,w=h.width,_=h.height,b=new Array(w*_),i=0;i<r.length;i+=4)b[i/4]=77*r[i]+150*r[i+1]+29*r[i+2]+128>>8;return{data:b,width:w,height:_}}},439:(M,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.skip2d=void 0,t.skip2d=function(h,r,w){for(var _=r[0],b=r[1],i=r[2],u=w[0],c=w[1],e=w[2],f=Math.ceil((e-u)/c),o=Math.ceil((i-_)/b),s=new Array(f*o),y=0;y<o;y++)for(var v=0;v<f;v++){var p=_+y*b,l=u+v*c;s[y*f+v]=h.data[p*h.width+l]}return{data:s,width:f,height:o}}},118:(M,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sub=void 0,t.sub=function(h,r,w,_,b){for(var i=h.data,u=h.width,c=new Array(b*w),e=0;e<w;e++)for(var f=0;f<b;f++)c[e*b+f]=i[(_+e)*u+r+f];return{data:c,width:b,height:w}}},240:(M,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.transpose=void 0,t.transpose=function(h){for(var r=h.data,w=h.width,_=h.height,b=new Array(w*_),i=0;i<_;i++)for(var u=0;u<w;u++)b[u*_+i]=r[i*w+u];return{data:b,height:w,width:_}}},799:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.zeros=void 0;var r=h(928);t.zeros=function(w,_){return _===void 0&&(_=w),r.numbers(w,_,0)}},595:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.originalSsim=void 0;var r=h(490),w=h(971);t.originalSsim=function(_,b,i){var u=w.fspecial("gaussian",i.windowSize,1.5),c=Math.pow(2,i.bitDepth)-1,e=Math.pow(i.k1*c,2),f=Math.pow(i.k2*c,2);u=r.divide2d(u,r.sum2d(u));var o=w.filter2(u,_,"valid"),s=w.filter2(u,b,"valid"),y=r.square2d(o),v=r.square2d(s),p=r.multiply2d(o,s),l=r.square2d(_),g=r.square2d(b),S=r.subtract2d(w.filter2(u,l,"valid"),y),A=r.subtract2d(w.filter2(u,g,"valid"),v),O=r.subtract2d(w.filter2(u,r.multiply2d(_,b),"valid"),p);if(e>0&&f>0){var x=r.add2d(r.multiply2d(p,2),e),E=r.add2d(r.multiply2d(O,2),f),P=r.add2d(r.add2d(y,v),e),$=r.add2d(r.add2d(S,A),f);return r.divide2d(r.multiply2d(x,E),r.multiply2d(P,$))}var j=r.multiply2d(p,2),I=r.multiply2d(O,2),T=r.add2d(y,v),D=r.add2d(S,A);return r.divide2d(r.multiply2d(j,I),r.multiply2d(T,D))}},773:(M,t,h)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ssim=void 0;var r=h(490),w=h(971);t.ssim=function(_,b,i){var u=w.normpdf((function(E){for(var P=Math.floor(E/2),$=new Array(2*P+1),j=-P;j<=P;j++)$[j+P]=Math.abs(j);return{data:$,width:$.length,height:1}})(i.windowSize),0,1.5),c=Math.pow(2,i.bitDepth)-1,e=Math.pow(i.k1*c,2),f=Math.pow(i.k2*c,2);u=r.divide2d(u,r.sum2d(u));var o=w.transpose(u),s=w.conv2(_,u,o,"valid"),y=w.conv2(b,u,o,"valid"),v=r.square2d(s),p=r.square2d(y),l=r.multiply2d(s,y),g=r.square2d(_),S=r.square2d(b),A=r.subtract2d(w.conv2(g,u,o,"valid"),v),O=r.subtract2d(w.conv2(S,u,o,"valid"),p),x=r.subtract2d(w.conv2(r.multiply2d(_,b),u,o,"valid"),l);return e>0&&f>0?(function(E,P,$,j,I,T,D,R){var z=r.add2d(r.multiply2d(E,2),D),C=r.add2d(r.multiply2d(P,2),R),U=r.add2d(r.add2d($,j),D),B=r.add2d(r.add2d(I,T),R);return r.divide2d(r.multiply2d(z,C),r.multiply2d(U,B))})(l,x,v,p,A,O,e,f):(function(E,P,$,j,I,T){var D=r.multiply2d(E,2),R=r.multiply2d(P,2),z=r.add2d($,j),C=r.add2d(I,T);return r.divide2d(r.multiply2d(D,R),r.multiply2d(z,C))})(l,x,v,p,A,O)}},535:function(M,t){var h=this&&this.__assign||function(){return(h=Object.assign||function(e){for(var f,o=1,s=arguments.length;o<s;o++)for(var y in f=arguments[o])Object.prototype.hasOwnProperty.call(f,y)&&(e[y]=f[y]);return e}).apply(this,arguments)};function r(e,f,o,s){return{rightEdge:o[f*s+e+1],bottomEdge:o[(f+1)*s+e],bottomRightEdge:o[(f+1)*s+e+1]}}function w(e,f){for(var o=e.width,s=e.height,y=e.data,v=o+1,p=s+1,l=new Int32Array(v*p),g=s-1;g>=0;--g)for(var S=o-1;S>=0;--S){var A=r(S,g,l,v),O=A.rightEdge,x=A.bottomEdge,E=A.bottomRightEdge;l[g*v+S]=f(y[g*o+S],S,g)+O+x-E}return{data:l,height:p,width:v}}function _(e,f,o){for(var s=e.width,y=e.height,v=e.data,p=f.data,l=s+1,g=y+1,S=new Int32Array(l*g),A=y-1;A>=0;--A)for(var O=s-1;O>=0;--O){var x=r(O,A,S,l),E=x.rightEdge,P=x.bottomEdge,$=x.bottomRightEdge,j=A*s+O;S[A*l+O]=o(v[j],p[j],O,A)+E+P-$}return{data:S,height:g,width:l}}function b(e,f,o){for(var s=e.width,y=e.height,v=e.data,p=s-1,l=y-1,g=p-f+1,S=l-f+1,A=new Int32Array(g*S),O=0;O<l;++O)for(var x=0;x<p;++x)if(x<g&&O<S){var E=v[s*O+x]-v[s*O+x+f]-v[s*(O+f)+x]+v[s*(O+f)+x+f];A[O*g+x]=E/o}return{height:S,width:g,data:A}}function i(e,f){return b(w(e,(function(o){return o})),f,1)}function u(e,f,o){for(var s=o*o,y=b(w(e,(function(S){return S*S})),o,1),v=0;v<f.data.length;++v){var p=f.data[v]/s,l=y.data[v]/s,g=p*p;y.data[v]=1024*(l-g)}return y}function c(e,f,o,s,y){for(var v=y*y,p=b(_(e,f,(function(g,S){return g*S})),y,1),l=0;l<o.data.length;++l)p.data[l]=1024*(p.data[l]/v-o.data[l]/v*(s.data[l]/v));return p}Object.defineProperty(t,"__esModule",{value:!0}),t.weberSsim=t.windowCovariance=t.windowVariance=t.windowSums=t.windowMatrix=t.partialSumMatrix2=t.partialSumMatrix1=void 0,t.partialSumMatrix1=w,t.partialSumMatrix2=_,t.windowMatrix=b,t.windowSums=i,t.windowVariance=u,t.windowCovariance=c,t.weberSsim=function(e,f,o){for(var s=o.bitDepth,y=o.k1,v=o.k2,p=o.windowSize,l=Math.pow(2,s)-1,g=y*l*(y*l),S=v*l*(v*l),A=p*p,O=h(h({},e),{data:Int32Array.from(e.data,(function(K){return K+.5}))}),x=h(h({},f),{data:Int32Array.from(f.data,(function(K){return K+.5}))}),E=i(O,p),P=u(O,E,p),$=i(x,p),j=u(x,$,p),I=c(O,x,E,$,p),T=E.data.length,D=0,R=new Array(T),z=0;z<T;++z){var C=E.data[z]/A,U=$.data[z]/A,B=P.data[z]/1024,ut=j.data[z]/1024,V=(2*C*U+g)*(I.data[z]/1024*2+S)/(C*C+U*U+g)/(B+ut+S);R[z]=V,z==0?D=V:D+=(V-D)/(z+1)}return{data:R,width:E.width,height:E.height,mssim:D}}}},m={};return(function M(t){if(m[t])return m[t].exports;var h=m[t]={exports:{}};return n[t].call(h.exports,h,h.exports,M),h.exports})(607)})()}))})(N)),N.exports}var _t=bt();function kt(a,d,n){if(n?.snapshotKey?.includes("-"))throw new Error("Snapshot key cannot contain dash");return a.hasImageSnapshot(d,n?.snapshotKey)}function Mt(a){if(!a||!(a instanceof Element))throw new Error(`Expected DOM element to be an instance of Element, received ${typeof a}`);return xt(a)}function St(a){return a.split("").map(d=>{const n=d.charCodeAt(0);return d===" "||d==="#"||d==="."||d===":"||d==="["||d==="]"||d===">"||d==="+"||d==="~"||d==="\\"?`\\${d}`:n>=65536?`\\${n.toString(16).toUpperCase().padStart(6,"0")} `:n<32||n===127?`\\${n.toString(16).toUpperCase().padStart(2,"0")} `:n>=128?`\\${n.toString(16).toUpperCase().padStart(2,"0")} `:d}).join("")}function xt(a){const d=[];let n,m=!1;for(;n=Ot(a);){n.shadowRoot&&(m=!0);const M=a.tagName;if(a.id)d.push(`#${St(a.id)}`);else if(!a.nextElementSibling&&!a.previousElementSibling)d.push(M.toLowerCase());else{let t=0,h=0,r=0;for(const w of n.children)t++,w.tagName===M&&h++,w===a&&(r=t);h>1?d.push(`${M.toLowerCase()}:nth-child(${r})`):d.push(M.toLowerCase())}a=n}return`${Pt().provider==="webdriverio"&&m?">>>":""}${d.reverse().join(" > ")}`}function Ot(a){const d=a.parentNode;return d instanceof ShadowRoot?d.host:d}function Pt(){return window.__vitest_browser_runner__}function At({failureThresholdType:a,width:d,height:n},m){switch(a){case"pixel":return m;case"percent":return m/(d*n)*100;default:throw new Error(`Unsupported failureThresholdType: ${a}`)}}function Et(a,d,n,m,M,t={}){const h=t.comparisonMethod==="ssim"?$t(a,d,n,m,M,t.diffOptions):yt(a,d,n,m,M,t.diffOptions),r=At({failureThresholdType:t.failureThresholdType??"pixel",width:m,height:M},h);return{pass:r<=(t.failureThreshold??0),diffAmount:r}}function $t(a,d,n,m,M,t){const{ssim_map:h,mssim:r}=_t.ssim({data:a,width:m,height:M},{data:d,width:m,height:M},{ssim:"bezkrovny",...t}),w=Math.round((1-r)*m*M),_=new DataView(n.buffer,n.byteOffset);for(let b=0;b!==M;++b)for(let i=0;i!==m;++i){const u=b*m+i,c=4278190080+Math.floor(255*(1-h.data[h.width*Math.round(h.height*b/M)+Math.round(h.width*i/m)]));_.setUint32(u*4,c)}return w}function Q(a){return new Promise((d,n)=>{const m=new Image;m.src=`data:image/png;base64,${a}`,m.onload=()=>{const M=document.createElement("canvas");M.width=m.width,M.height=m.height;const t=M.getContext("2d");t.drawImage(m,0,0),d(t.getImageData(0,0,M.width,M.height))},m.onerror=()=>{n(new Error("Failed to load image"))}})}async function jt(a){const d=document.createElement("canvas");return d.width=a.width,d.height=a.height,d.getContext("2d").putImageData(a,0,0),new Promise(n=>{d.toBlob(m=>{const M=new FileReader;M.onload=()=>{n(M.result)},M.readAsDataURL(m)})})}let ot;globalThis.__vitest_browser__&&rt(()=>import("./context-Beh5KHTz.js"),[],import.meta.url).then(a=>{ot=a});const It=new Proxy({},{get(a,d){return a[d]??(ot?.server)[d]}});function Tt(a,d){return{width:Math.max(a.width,d.width),height:Math.max(a.height,d.height)}}function dt(a,d){return a.width===d.width&&a.height===d.height}const zt=({width:a,height:d})=>n=>{if(dt(n,{width:a,height:d}))return n;const m=(h,r)=>r<=n.height&&h<=n.width,M=new Uint8ClampedArray(a*d*4),t=new ImageData(M,a,d,{colorSpace:n.colorSpace});for(let h=0;h<d;h++)for(let r=0;r<a;r++){const w=a*h+r<<2;if(m(r,h)){const _=n.width*h+r<<2;t.data[w]=n.data[_],t.data[w+1]=n.data[_+1],t.data[w+2]=n.data[_+2],t.data[w+3]=n.data[_+3]}else t.data[w]=0,t.data[w+1]=0,t.data[w+2]=0,t.data[w+3]=64}return t};function Dt(a,d){if(dt(a,d))return[a,d];const n=zt(Tt(a,d));return[n(a),n(d)]}function tt(a){return a?[`failureThreshold: ${a.failureThreshold??0} ${a.failureThresholdType??"pixels"}`,a.timeout?`timeout: ${a.timeout} ms`:"",`comparisonMethod: ${a.comparisonMethod??"pixel"}`,a.diffOptions?`diffOptions: ${JSON.stringify(a.diffOptions)}`:""].filter(Boolean).join(`
                 `):"none"}async function st(a,d,n,m){m={...n,...m};const M=await Q(n.baseline),t=await Q(n.result),[h,r]=Dt(M,t),{width:w,height:_}=h,b=new ImageData(w,_),{pass:i,diffAmount:u}=Et(h.data,r.data,b.data,w,_,m);if(i){if(m?.expectToFail)throw new Error(Y`Snapshot \`${d}\` matched but expected to fail.

							Options:    ${tt(m)}
							Diff:       ${m.failureThresholdType==="percent"?`${u}%`:`${u} pixels`}

							Expected:   ${k(n.projectRoot,n.baselinePath)}
							Actual:     ${k(n.projectRoot,n.resultPath)}`);return}if(It.config.snapshotOptions.updateSnapshot==="all"&&!m?.expectToFail){await et(a,k(n.projectRoot,n.baselinePath),t);return}throw await et(a,k(n.projectRoot,n.diffPath),b),new Error(Y`Snapshot \`${d}\` mismatched

					${m?.failureThreshold?m?.failureThresholdType==="percent"?`Expected image to match within ${m.failureThreshold}% but was differ by ${u}%.`:`Expected image to match within ${m.failureThreshold} pixels but was differ by ${u} pixels.`:`Expected image to match but was differ by ${m?.failureThresholdType==="percent"?`${u}%`:`${u} pixels`}.`}${M.width!==t.width||M.height!==t.height?`
The image size changed from ${M.width}x${M.height} to ${t.width}x${t.height}.`:""}

					Options:    ${tt(m)}

					Expected:   ${k(n.projectRoot,n.baselinePath)}
					Actual:     ${k(n.projectRoot,n.resultPath)}
					Difference: ${k(n.projectRoot,n.diffPath)}`)}async function et(a,d,n){const m=(await jt(n)).split(",")[1];return a.writeFile(d,m,{encoding:"base64"})}async function Ut(a,d,n,m){at(m?.snapshotKey);const M=await a.prepareImageSnapshotComparison(d,Rt(n),m);if(M)return st(a,d,M,m)}function Rt(a){if(a instanceof Element)return Mt(a);if(a?.selector)return a.selector;if(ft(a))return a;throw new Error(`'toMatchImageSnapshot()' expects the subject to be an element, locator, or image encoded in base64 string, but got: ${a}`)}async function qt(a,d,n){at(n?.snapshotKey);const m=await a.preparePageImageSnapshotComparison(d,n);if(m)return st(a,d,m,n)}const Lt={pass:!0,message:()=>""};function Bt(a){const d=[];let n=a;for(;n?.suite;)d.unshift(n.suite.name.replace(/[^a-z0-9]/gi,"-").toLowerCase()),n=n.suite;return d.push(a.name.replace(/[^a-z0-9]/gi,"-").toLowerCase()),d.join("/")}export{Ut as a,kt as h,qt as m,Lt as s,Bt as t};
